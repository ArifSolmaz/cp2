<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Week 03 â€” PhoneLab</title>
  <link rel="stylesheet" href="../assets/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand-title">Week 03 â€” Reaction Time Analyzer</div>
      <div class="brand-sub"><a href="../index.html">â† Back to PhoneLab Hub</a></div>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h1 style="margin:0 0 4px;">â±ï¸ Reaction Time Analyzer</h1>
      <p class="muted" style="margin:0 0 12px;">
        How fast are your reflexes? Measure your reaction time 10 times,
        then use <b>loops</b> to analyze the data.
      </p>

      <div class="concepts-box">
        <b>ğŸ“š Concepts you'll practice (from Week 03):</b>
        <span class="concept-tag">for loop</span>
        <span class="concept-tag">while loop</span>
        <span class="concept-tag">range()</span>
        <span class="concept-tag">break / continue</span>
        <span class="concept-tag">accumulator pattern</span>
      </div>

      <hr />

      <details open>
        <summary><b>1) Identity</b> <span class="muted">(required)</span></summary>
        <div class="row">
          <div>
            <label>Student ID (6â€“12 digits)</label>
            <input id="studentId" inputmode="numeric" minlength="6" maxlength="12"
                   pattern="^\d{6,12}$" required placeholder="e.g., 202612345" />
          </div>
          <div>
            <label>Name Surname</label>
            <input id="nameSurname" required placeholder="e.g., Arif Solmaz" />
          </div>
        </div>
        <label>Email (@istun.edu.tr)</label>
        <input id="email" type="email"
               pattern="^[A-Za-z0-9._%+-]+@istun\.edu\.tr$"
               required placeholder="name@istun.edu.tr" />
        <small class="hint">Draft auto-saves on this device.</small>
      </details>

      <hr />

      <details open>
        <summary><b>2) Collect your data</b> <span class="muted">(10 reaction times)</span></summary>

        <div class="scenario-box">
          <b>ğŸ”¬ What to do:</b>
          <ol class="muted" style="margin:6px 0 0; padding-left:20px;">
            <li>Go to <a href="https://humanbenchmark.com/tests/reactiontime" target="_blank" style="color:#10b981;"><b>humanbenchmark.com/tests/reactiontime</b></a> on your phone browser.</li>
            <li>Do <b>10 trials</b>. After each trial, write down the time in <b>milliseconds</b> (ms).</li>
            <li>Enter all 10 values below, separated by commas.</li>
          </ol>
          <small class="muted" style="display:block; margin-top:8px;">
            ğŸ’¡ Average human reaction time is 200â€“250 ms. Below 200 ms is fast!
          </small>
        </div>

        <label>Your 10 reaction times (ms, comma-separated)</label>
        <textarea id="dataBox" spellcheck="false"></textarea>
        <small class="hint">Example: 245, 312, 198, 267, 223, 289, 201, 256, 234, 210</small>
      </details>

      <hr />

      <details open>
        <summary><b>3) Python code</b> <span class="muted">(write the loops)</span></summary>
        <label>Python â€” use loops to analyze your data</label>
        <textarea id="codeBox" class="codebox" spellcheck="false"></textarea>
        <small class="hint">
          Use <b>for</b> loops to iterate through your reaction times.
          The code has TODO sections for you to complete.
        </small>
      </details>

      <hr />

      <details open>
        <summary><b>4) Output</b> <span class="muted">(auto-captured after Run)</span></summary>
        <pre id="output" class="out">Click "Run Python" to see output here.</pre>
      </details>

      <div class="stickybar">
        <div class="bar-actions">
          <button id="helpBtn" class="helpbtn" type="button">Instructions</button>
          <button id="runBtn" type="button">â–¶ Run Python</button>
          <button id="submitBtn" class="primary" type="button">Submit</button>
        </div>
        <small id="status" class="hint"></small>
      </div>
    </section>
  </main>

  <!-- Help Modal -->
  <div id="helpModal" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <h3>Week 03 â€” Instructions</h3>
      <ol class="muted">
        <li><b>Identity:</b> Student ID, Name Surname, <b>@istun.edu.tr</b> email.</li>
        <li><b>Measure:</b> Go to humanbenchmark.com and do 10 reaction time trials.</li>
        <li><b>Enter data:</b> Type your 10 times (ms) separated by commas.</li>
        <li><b>Write code:</b> Use <b>for loops</b> to compute stats. Fill in the TODO sections.</li>
        <li><b>Run &amp; Submit:</b> Check output, then submit once.</li>
      </ol>
      <p class="muted" style="margin-top:10px;">
        <b>No internet?</b> Use a phone stopwatch instead:<br/>
        Have a friend say "GO!" â€” tap as fast as you can. Record 10 times in seconds, then multiply by 1000 to convert to ms.
      </p>
      <div class="modal-actions">
        <button id="closeHelpBtn" type="button">Close</button>
      </div>
    </div>
  </div>

  <script src="../assets/app.js"></script>
  <script>
    const WEEK = "week03";

    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxu_JAL7pMXz_7bSGC7kIYvs76UGJji8ubbmr6h7rnLY-M2deKSubTxTiekeKecMclC/exec";

    const studentIdEl  = document.getElementById("studentId");
    const nameSurnameEl = document.getElementById("nameSurname");
    const emailEl      = document.getElementById("email");
    const dataEl       = document.getElementById("dataBox");
    const codeEl       = document.getElementById("codeBox");
    const outEl        = document.getElementById("output");
    const statusEl     = document.getElementById("status");

    const defaultData = `245, 312, 198, 267, 223, 289, 201, 256, 234, 210`;

    const starterCode =
`# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Week 03 â€” Reaction Time Analyzer
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DATA is a string like "245, 312, 198, ..."
# The line below converts it into a list of numbers.
# (You'll learn about lists properly in Week 5 â€”
#  for now, just know that 'times' is a sequence
#  you can loop over with 'for')

_parts = DATA.strip().split(",")
times = []
for _p in _parts:
    times.append(float(_p.strip()))

n = len(times)

print("=" * 44)
print("â±ï¸  REACTION TIME REPORT")
print("=" * 44)
print(f"Trials recorded: {n}")
print("-" * 44)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 1: Print each trial using a for loop
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Use range(n) to get trial numbers 0, 1, 2, ...
# Print each as "Trial 1: 245 ms" (add 1 to start from 1)

for i in range(n):
    print(f"  Trial {i + 1}: {times[i]:.0f} ms")

print("-" * 44)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 2: Calculate TOTAL using a for loop
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Use the accumulator pattern:
# Start with total = 0, then add each time

total = 0
for t in times:
    total = total + t

average = total / n
print(f"Total time  : {total:.0f} ms")
print(f"Average     : {average:.1f} ms")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 3: Find FASTEST and SLOWEST with a loop
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Start with fastest = times[0], then check each time

fastest = times[0]
slowest = times[0]

for t in times:
    if t < fastest:
        fastest = t
    if t > slowest:
        slowest = t

print(f"Fastest     : {fastest:.0f} ms")
print(f"Slowest     : {slowest:.0f} ms")
print(f"Range       : {slowest - fastest:.0f} ms")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 4: Count FAST reactions (< 230 ms)
#         using a for loop with if
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

fast_threshold = 230
fast_count = 0

for t in times:
    if t < fast_threshold:
        fast_count = fast_count + 1

slow_count = n - fast_count

print(f"Fast (<{fast_threshold}ms): {fast_count} / {n}")
print(f"Slow (â‰¥{fast_threshold}ms): {slow_count} / {n}")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 5: Check for IMPROVEMENT trend
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Compare first half average vs second half average
# Use range() to loop through first 5, then last 5

first_half_total = 0
for i in range(n // 2):
    first_half_total = first_half_total + times[i]
first_half_avg = first_half_total / (n // 2)

second_half_total = 0
for i in range(n // 2, n):
    second_half_total = second_half_total + times[i]
second_half_avg = second_half_total / (n - n // 2)

print("-" * 44)
print(f"First half avg  : {first_half_avg:.1f} ms")
print(f"Second half avg : {second_half_avg:.1f} ms")

if second_half_avg < first_half_avg:
    improvement = first_half_avg - second_half_avg
    print(f"ğŸ“ˆ You IMPROVED by {improvement:.1f} ms!")
else:
    decline = second_half_avg - first_half_avg
    print(f"ğŸ“‰ You slowed down by {decline:.1f} ms")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 6: Performance rating
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

print("-" * 44)
if average < 200:
    print("ğŸ† RATING: Elite â€” faster than most humans!")
elif average < 250:
    print("ğŸ¥‡ RATING: Fast â€” excellent reflexes!")
elif average < 300:
    print("ğŸ¥ˆ RATING: Average â€” normal human range")
elif average < 400:
    print("ğŸ¥‰ RATING: Below average â€” keep practicing!")
else:
    print("ğŸ’¤ RATING: Slow â€” were you sleepy?")

print("=" * 44)
`;

    // â”€â”€ Wiring â”€â”€
    function save(){
      PhoneLabUI.saveDraft(WEEK, {
        studentId: studentIdEl.value, nameSurname: nameSurnameEl.value,
        email: emailEl.value, data: dataEl.value, code: codeEl.value,
        output: outEl.textContent, savedAt: new Date().toISOString()
      });
      statusEl.textContent = "Draft saved.";
    }

    function submitViaForm(payload){
      const form = document.createElement("form");
      form.method = "POST"; form.action = SCRIPT_URL; form.target = "_blank";
      const inp = document.createElement("input");
      inp.type = "hidden"; inp.name = "payload"; inp.value = JSON.stringify(payload);
      form.appendChild(inp); document.body.appendChild(form); form.submit(); form.remove();
    }

    const draft = PhoneLabUI.loadDraft(WEEK);
    if (draft){
      studentIdEl.value = draft.studentId || "";
      nameSurnameEl.value = draft.nameSurname || "";
      emailEl.value = draft.email || "";
      dataEl.value = draft.data || defaultData;
      codeEl.value = draft.code || starterCode;
      outEl.textContent = draft.output || 'Click "Run Python" to see output here.';
      statusEl.textContent = "Draft loaded.";
    } else {
      dataEl.value = defaultData;
      codeEl.value = starterCode;
    }

    [studentIdEl, nameSurnameEl, emailEl, dataEl, codeEl].forEach(el =>
      el.addEventListener("input", save));

    document.getElementById("runBtn").addEventListener("click", async () => {
      statusEl.textContent = "Loading Python runtimeâ€¦";
      const dataLiteral = JSON.stringify(dataEl.value);
      const codeToRun = `DATA = ${dataLiteral}\n\n` + codeEl.value;
      try {
        const out = await PhoneLabUI.runPythonCapture(codeToRun);
        outEl.textContent = out || "(no output)";
        statusEl.textContent = "âœ… Run complete.";
        save();
      } catch (e) {
        outEl.textContent = String(e);
        statusEl.textContent = "âŒ Error â€” check your code.";
        save();
      }
    });

    document.getElementById("submitBtn").addEventListener("click", () => {
      const studentId   = studentIdEl.value.trim();
      const nameSurname = nameSurnameEl.value.trim();
      const email       = emailEl.value.trim().toLowerCase();
      if (!/^\d{6,12}$/.test(studentId))
        { statusEl.textContent = "Student ID must be 6â€“12 digits."; return; }
      if (nameSurname.split(/\s+/).filter(Boolean).length < 2)
        { statusEl.textContent = "Enter Name and Surname."; return; }
      if (!/^[A-Za-z0-9._%+-]+@istun\.edu\.tr$/.test(email))
        { statusEl.textContent = "Email must be @istun.edu.tr"; return; }

      const payload = {
        week: WEEK, studentId, nameSurname, email,
        data: dataEl.value, code: codeEl.value, output: outEl.textContent,
        userAgent: navigator.userAgent, submittedAt: new Date().toISOString()
      };
      statusEl.textContent = "Submittingâ€¦";
      submitViaForm(payload);
      PhoneLabUI.setStatus(WEEK, "submitted");
    });

    const helpModal = document.getElementById("helpModal");
    document.getElementById("helpBtn").addEventListener("click", () => helpModal.style.display = "flex");
    document.getElementById("closeHelpBtn").addEventListener("click", () => helpModal.style.display = "none");
    helpModal.addEventListener("click", e => { if (e.target === helpModal) helpModal.style.display = "none"; });
    document.addEventListener("keydown", e => { if (e.key === "Escape") helpModal.style.display = "none"; });
  </script>
</body>
</html>