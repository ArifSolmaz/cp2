<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Week 02 â€” PhoneLab</title>
  <link rel="stylesheet" href="../assets/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand-title">Week 02 â€” Room Comfort Classifier</div>
      <div class="brand-sub"><a href="../index.html">â† Back to PhoneLab Hub</a></div>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h1 style="margin:0 0 4px;">ğŸŒ¡ï¸ Room Comfort Classifier</h1>
      <p class="muted" style="margin:0 0 12px;">
        Is your room safe and comfortable to work in?
        Measure real conditions, then write a classifier that decides.
      </p>

      <div class="concepts-box">
        <b>ğŸ“š Concepts you'll practice (from Week 02):</b>
        <span class="concept-tag">if / elif / else</span>
        <span class="concept-tag">comparison (&lt; &gt; == !=)</span>
        <span class="concept-tag">and / or / not</span>
        <span class="concept-tag">boolean variables</span>
        <span class="concept-tag">nested if</span>
      </div>

      <hr />

      <details open>
        <summary><b>1) Identity</b> <span class="muted">(required)</span></summary>
        <div class="row">
          <div>
            <label>Student ID (6â€“12 digits)</label>
            <input id="studentId" inputmode="numeric" minlength="6" maxlength="12"
                   pattern="^\d{6,12}$" required placeholder="e.g., 202612345" />
          </div>
          <div>
            <label>Name Surname</label>
            <input id="nameSurname" required placeholder="e.g., Arif Solmaz" />
          </div>
        </div>
        <label>Email (@istun.edu.tr)</label>
        <input id="email" type="email"
               pattern="^[A-Za-z0-9._%+-]+@istun\.edu\.tr$"
               required placeholder="name@istun.edu.tr" />
        <small class="hint">Draft auto-saves on this device.</small>
      </details>

      <hr />

      <details open>
        <summary><b>2) Collect your data</b> <span class="muted">(from your phone)</span></summary>

        <div class="scenario-box">
          <b>ğŸ”¬ What to do:</b>
          <ol class="muted" style="margin:6px 0 0; padding-left:20px;">
            <li>Open a <b>weather app</b> â€” note the current temperature (Â°C) for your location.</li>
            <li>Check <b>humidity %</b> in the same weather app.</li>
            <li>Estimate the <b>light level</b>: look around your room and rate it 0â€“1000 lux.<br/>
                <small>ğŸ’¡ Dark room â‰ˆ 50, normal room â‰ˆ 300, bright office â‰ˆ 500, direct sunlight â‰ˆ 1000</small></li>
            <li>Estimate <b>noise level</b> in dB using a free sound meter app, or guess:<br/>
                <small>ğŸ”‡ Library â‰ˆ 30, normal room â‰ˆ 45, conversation â‰ˆ 60, traffic â‰ˆ 75, concert â‰ˆ 100</small></li>
          </ol>
        </div>

        <label>Your measurements (edit the numbers)</label>
        <textarea id="dataBox" spellcheck="false"></textarea>
        <small class="hint">Change only the numbers after <code>=</code>.</small>
      </details>

      <hr />

      <details open>
        <summary><b>3) Python code</b> <span class="muted">(write the if/elif/else logic)</span></summary>
        <label>Python â€” fill in the classification logic</label>
        <textarea id="codeBox" class="codebox" spellcheck="false"></textarea>
        <small class="hint">
          Use <b>if/elif/else</b> to classify each measurement.
          Combine with <b>and/or/not</b> for the final verdict.
        </small>
      </details>

      <hr />

      <details open>
        <summary><b>4) Output</b> <span class="muted">(auto-captured after Run)</span></summary>
        <pre id="output" class="out">Click "Run Python" to see output here.</pre>
      </details>

      <div class="stickybar">
        <div class="bar-actions">
          <button id="helpBtn" class="helpbtn" type="button">Instructions</button>
          <button id="runBtn" type="button">â–¶ Run Python</button>
          <button id="submitBtn" class="primary" type="button">Submit</button>
        </div>
        <small id="status" class="hint"></small>
      </div>
    </section>
  </main>

  <!-- Help Modal -->
  <div id="helpModal" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <h3>Week 02 â€” Instructions</h3>
      <ol class="muted">
        <li><b>Identity:</b> Student ID, Name Surname, <b>@istun.edu.tr</b> email.</li>
        <li><b>Measure:</b> Get temperature &amp; humidity from a weather app. Estimate light (lux) and noise (dB) for your current room.</li>
        <li><b>Write code:</b> Use <b>if/elif/else</b> to classify each condition, then combine them with <b>and/or/not</b>.</li>
        <li><b>Run:</b> Click "Run Python" and check the output.</li>
        <li><b>Submit:</b> One submission only. Confirmation opens in a new tab.</li>
      </ol>
      <p class="muted" style="margin-top:10px;"><b>Tip:</b> Try changing the numbers and re-running to see how your classifier responds to different conditions!</p>
      <div class="modal-actions">
        <button id="closeHelpBtn" type="button">Close</button>
      </div>
    </div>
  </div>

  <script src="../assets/app.js"></script>
  <script>
    const WEEK = "week02";

    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxu_JAL7pMXz_7bSGC7kIYvs76UGJji8ubbmr6h7rnLY-M2deKSubTxTiekeKecMclC/exec";

    const studentIdEl  = document.getElementById("studentId");
    const nameSurnameEl = document.getElementById("nameSurname");
    const emailEl      = document.getElementById("email");
    const dataEl       = document.getElementById("dataBox");
    const codeEl       = document.getElementById("codeBox");
    const outEl        = document.getElementById("output");
    const statusEl     = document.getElementById("status");

    const defaultData =
`temperature_C=24.5
humidity_percent=55
light_lux=320
noise_dB=42`;

    const starterCode =
`# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Week 02 â€” Room Comfort Classifier
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DATA is a string with your measurements.
# The lines below read them into variables.

_lines = DATA.strip().split("\\n")
temperature_C    = float(_lines[0].split("=")[1])
humidity_percent = float(_lines[1].split("=")[1])
light_lux        = float(_lines[2].split("=")[1])
noise_dB         = float(_lines[3].split("=")[1])

print("=" * 42)
print("ğŸŒ¡ï¸  ROOM COMFORT REPORT")
print("=" * 42)
print(f"Temperature : {temperature_C} Â°C")
print(f"Humidity    : {humidity_percent} %")
print(f"Light       : {light_lux} lux")
print(f"Noise       : {noise_dB} dB")
print("-" * 42)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 1: TEMPERATURE classification
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Cold:    below 18 Â°C
# Cool:    18â€“21 Â°C
# Comfort: 21â€“26 Â°C
# Warm:    26â€“30 Â°C
# Hot:     above 30 Â°C

if temperature_C < 18:
    temp_status = "â„ï¸ COLD"
elif temperature_C < 21:
    temp_status = "ğŸŒ¤ï¸ Cool"
elif temperature_C <= 26:
    temp_status = "âœ… Comfortable"
elif temperature_C <= 30:
    temp_status = "ğŸŸ¡ Warm"
else:
    temp_status = "ğŸ”´ HOT"

print(f"Temp status : {temp_status}")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 2: HUMIDITY classification
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Dry:     below 30%
# Comfort: 30â€“60%
# Humid:   60â€“80%
# Very humid: above 80%

if humidity_percent < 30:
    humid_status = "ğŸœï¸ Dry"
elif humidity_percent <= 60:
    humid_status = "âœ… Comfortable"
elif humidity_percent <= 80:
    humid_status = "ğŸ’§ Humid"
else:
    humid_status = "ğŸ”´ Very Humid"

print(f"Humidity    : {humid_status}")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 3: LIGHT classification
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Dark:     below 100 lux
# Dim:      100â€“300 lux
# Good:     300â€“500 lux
# Bright:   above 500 lux

if light_lux < 100:
    light_status = "ğŸŒ‘ Too Dark"
elif light_lux < 300:
    light_status = "ğŸŒ’ Dim"
elif light_lux <= 500:
    light_status = "âœ… Good"
else:
    light_status = "â˜€ï¸ Bright"

print(f"Light       : {light_status}")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 4: NOISE classification
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Quiet:     below 35 dB
# Normal:    35â€“55 dB
# Noisy:     55â€“75 dB
# Dangerous: above 75 dB (hearing damage risk!)

if noise_dB < 35:
    noise_status = "ğŸ¤« Quiet"
elif noise_dB <= 55:
    noise_status = "âœ… Normal"
elif noise_dB <= 75:
    noise_status = "ğŸ”Š Noisy"
else:
    noise_status = "ğŸ”´ DANGEROUS"

print(f"Noise       : {noise_status}")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TODO 5: OVERALL VERDICT using and / or / not
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Create boolean variables for each condition:

temp_ok  = temperature_C >= 21 and temperature_C <= 26
humid_ok = humidity_percent >= 30 and humidity_percent <= 60
light_ok = light_lux >= 300 and light_lux <= 500
noise_ok = noise_dB <= 55

# Count how many are OK
ok_count = 0
if temp_ok:
    ok_count = ok_count + 1
if humid_ok:
    ok_count = ok_count + 1
if light_ok:
    ok_count = ok_count + 1
if noise_ok:
    ok_count = ok_count + 1

print("-" * 42)

# Final verdict using boolean logic
all_ok = temp_ok and humid_ok and light_ok and noise_ok
any_danger = temperature_C > 35 or noise_dB > 85

if any_danger:
    print("ğŸš¨ VERDICT: UNSAFE â€” leave this area!")
elif all_ok:
    print("âœ… VERDICT: PERFECT working conditions!")
elif ok_count >= 3:
    print("ğŸŸ¡ VERDICT: Mostly fine, minor issues.")
elif ok_count >= 2:
    print("ğŸŸ  VERDICT: Several issues â€” consider moving.")
else:
    print("ğŸ”´ VERDICT: Poor conditions â€” not recommended.")

print(f"   ({ok_count}/4 factors in comfort range)")
print("=" * 42)
`;

    // â”€â”€ Wiring â”€â”€
    function save(){
      PhoneLabUI.saveDraft(WEEK, {
        studentId: studentIdEl.value, nameSurname: nameSurnameEl.value,
        email: emailEl.value, data: dataEl.value, code: codeEl.value,
        output: outEl.textContent, savedAt: new Date().toISOString()
      });
      statusEl.textContent = "Draft saved.";
    }

    function submitViaForm(payload){
      const form = document.createElement("form");
      form.method = "POST"; form.action = SCRIPT_URL; form.target = "_blank";
      const inp = document.createElement("input");
      inp.type = "hidden"; inp.name = "payload"; inp.value = JSON.stringify(payload);
      form.appendChild(inp); document.body.appendChild(form); form.submit(); form.remove();
    }

    const draft = PhoneLabUI.loadDraft(WEEK);
    if (draft){
      studentIdEl.value = draft.studentId || "";
      nameSurnameEl.value = draft.nameSurname || "";
      emailEl.value = draft.email || "";
      dataEl.value = draft.data || defaultData;
      codeEl.value = draft.code || starterCode;
      outEl.textContent = draft.output || 'Click "Run Python" to see output here.';
      statusEl.textContent = "Draft loaded.";
    } else {
      dataEl.value = defaultData;
      codeEl.value = starterCode;
    }

    [studentIdEl, nameSurnameEl, emailEl, dataEl, codeEl].forEach(el =>
      el.addEventListener("input", save));

    document.getElementById("runBtn").addEventListener("click", async () => {
      statusEl.textContent = "Loading Python runtimeâ€¦";
      const dataLiteral = JSON.stringify(dataEl.value);
      const codeToRun = `DATA = ${dataLiteral}\n\n` + codeEl.value;
      try {
        const out = await PhoneLabUI.runPythonCapture(codeToRun);
        outEl.textContent = out || "(no output)";
        statusEl.textContent = "âœ… Run complete.";
        save();
      } catch (e) {
        outEl.textContent = String(e);
        statusEl.textContent = "âŒ Error â€” check your code.";
        save();
      }
    });

    document.getElementById("submitBtn").addEventListener("click", () => {
      const studentId   = studentIdEl.value.trim();
      const nameSurname = nameSurnameEl.value.trim();
      const email       = emailEl.value.trim().toLowerCase();
      if (!/^\d{6,12}$/.test(studentId))
        { statusEl.textContent = "Student ID must be 6â€“12 digits."; return; }
      if (nameSurname.split(/\s+/).filter(Boolean).length < 2)
        { statusEl.textContent = "Enter Name and Surname."; return; }
      if (!/^[A-Za-z0-9._%+-]+@istun\.edu\.tr$/.test(email))
        { statusEl.textContent = "Email must be @istun.edu.tr"; return; }

      // Block default data submission
      if (dataEl.value.replace(/\s+/g,"") === defaultData.replace(/\s+/g,"")) {
        statusEl.textContent = "âš ï¸ Enter YOUR OWN room measurements â€” default values are not accepted.";
        dataEl.style.outline = "2px solid #ef4444";
        setTimeout(() => dataEl.style.outline = "", 3000);
        return;
      }

      if (!outEl.textContent || outEl.textContent.includes("Click") || outEl.textContent === "(no output)")
        { statusEl.textContent = "âš ï¸ Run your code first before submitting."; return; }

      const payload = {
        week: WEEK, studentId, nameSurname, email,
        data: dataEl.value, code: codeEl.value, output: outEl.textContent,
        userAgent: navigator.userAgent, submittedAt: new Date().toISOString()
      };
      statusEl.textContent = "Submittingâ€¦";
      submitViaForm(payload);
      PhoneLabUI.setStatus(WEEK, "submitted");
    });

    const helpModal    = document.getElementById("helpModal");
    document.getElementById("helpBtn").addEventListener("click", () => helpModal.style.display = "flex");
    document.getElementById("closeHelpBtn").addEventListener("click", () => helpModal.style.display = "none");
    helpModal.addEventListener("click", e => { if (e.target === helpModal) helpModal.style.display = "none"; });
    document.addEventListener("keydown", e => { if (e.key === "Escape") helpModal.style.display = "none"; });
  </script>
</body>
</html>
